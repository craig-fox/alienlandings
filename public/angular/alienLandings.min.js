(function(){angular.module("alienLandingsApp",["ngRoute","ngSanitize","ui.bootstrap"]);function n(n,e){n.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"/common/views/genericText.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/landing/:landingid",{templateUrl:"/landingDetail/landingDetail.view.html",controller:"landingDetailCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});e.html5Mode({enabled:true,requireBase:false})}angular.module("alienLandingsApp").config(["$routeProvider","$locationProvider",n])})();(function(){angular.module("alienLandingsApp").controller("homeCtrl",n);n.$inject=["$scope","alienLandingsData","geolocation"];function n(n,e,t){var a=this;a.pageHeader={title:"Alien Landings",strapline:"Seeking where extraterrestials have visited"};a.sidebar={content:"The truth is out there. For the last hundred years, "+"alien spacecraft have been visiting our planet. Or so say a few vividly "+"imaginative folks with one too many viewings of Close Encounters of the Third Kind "+"under the belt. But do we dare doubt? Right now, E.T. may be watching."};a.message="Checking your location";a.getData=function(n){var t=n.coords.latitude,i=n.coords.longitude;a.message="Searching for alien landing sites";e.landingByCoords(t,i).success(function(n){a.message=n.length>0?"":"No locations found";a.data={landings:n}}).error(function(n){a.message="An error occurred while retrieving data";console.log(n)})};a.showError=function(e){n.$apply(function(){a.message=e.message})};a.noGeo=function(){n.$apply(function(){a.message="Geolocation is not supported by this browser"})};t.getPosition(a.getData,a.showError,a.noGeo)}})();(function(){angular.module("alienLandingsApp").controller("aboutCtrl",n);function n(){var n=this;n.pageHeader={title:"About Alien Landings"};n.main={content:"Alien Landings was created to help people find the sites where alien visitors may have landed,"+"and give conspiracy theorists plenty of justification in life.\n"+"Find where Elvis was transported from this cruel world to a better one, today!"}}})();(function(){angular.module("alienLandingsApp").controller("landingDetailCtrl",n);n.$inject=["$routeParams","$uibModal","alienLandingsData","credibility"];function n(n,e,t,a){var i=this;i.landingid=n.landingid;t.landingById(i.landingid).success(function(n){i.data={landing:n};i.data.landing.credibility=a.getCredibility(i.data.landing.ratings);i.data.landing.selectedRating=2;i.pageHeader={title:i.data.landing.name}}).error(function(n){console.log(n)});i.onRatingSubmit=function(){t.addRatingToLanding(i.landingid,{selectedRating:i.data.landing.selectedRating}).success(function(n){alert("Cool bananas")}).error(function(n){alert("Ahhh fuck it")})};i.popupQuoteForm=function(){var n=e.open({templateUrl:"/quoteModal/quoteModal.view.html",controller:"quoteModalCtrl as vm",resolve:{landingData:function(){return{landingid:i.landingid,landingName:i.data.landing.name}}}});n.result.then(function(n){i.data.landing.quotes.push(n)})}}})();(function(){angular.module("alienLandingsApp").controller("quoteModalCtrl",n);n.$inject=["$uibModalInstance","alienLandingsData","landingData"];function n(n,e,t){var a=this;a.landingData=t;a.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"];a.format=a.formats[0];a.altInputFormats=["M!/d!/yyyy"];a.dateOptions={maxDate:new Date,showWeeks:true};a.takenAtPopup={opened:false};a.openTakenAtPopup=function(){a.takenAtPopup.opened=true};a.onSubmit=function(){a.formError="";if(!a.formData.name||!a.formData.takenAt||!a.formData.quoteText){a.formError="All fields required, please try again";return false}else{a.doAddQuote(a.landingData.landingid,a.formData)}};a.doAddQuote=function(n,t){e.addQuoteById(n,{author:t.name,takenAt:t.takenAt,quoteText:t.quoteText,menInBlack:t.menInBlack}).success(function(n){a.modal.close(n)}).error(function(n){a.formError="Your quote has not been saved, please try again"});return false};a.modal={close:function(e){n.close(e)},cancel:function(){n.dismiss("cancel")}}}})();(function(){angular.module("alienLandingsApp").service("geolocation",n);function n(){var n=function(n,e,t){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(n,e)}else{t()}};return{getPosition:n}}})();(function(){angular.module("alienLandingsApp").service("alienLandingsData",n);n.$inject=["$http"];function n(n){var e=function(e,t){return n.get("api/landings?lng="+t+"&lat="+e+"&maxDistance=20000")};var t=function(e){return n.get("/api/landings/"+e)};var a=function(e,t){return n.post("/api/landings/"+e+"/quotes",t)};var i=function(e,t){return n.put("/api/landings/"+e,t)};return{landingByCoords:e,landingById:t,addQuoteById:a,addRatingToLanding:i}}})();(function(){angular.module("alienLandingsApp").service("credibility",n);function n(){var n=function(n){var e=0;for(var t=0;t<n.length;t++){e+=parseInt(n[t],10)}return Math.round(e/n.length)};return{getCredibility:n}}})();(function(){angular.module("alienLandingsApp").filter("formatDistance",e);var n=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};function e(){return function(e){var t,a;if(e&&n(e)){if(e>1){t=parseFloat(e).toFixed(1);a="km"}else{t=parseInt(e*1e3,10);a="m"}return t+a}else{return"?"}}}})();(function(){angular.module("alienLandingsApp").filter("addHtmlLineBreaks",n);function n(){return function(n){var e=n.replace(/\n/g,"<br/>");return e}}})();(function(){angular.module("alienLandingsApp").directive("credibilityStars",n);function n(){return{restrict:"EA",scope:{thisCredibility:"=credibility"},templateUrl:"/common/directives/credibilityStars/credibility-stars.html"}}})();(function(){angular.module("alienLandingsApp").directive("footerGeneric",n);function n(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("alienLandingsApp").directive("navigation",n);function n(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("alienLandingsApp").directive("pageHeader",n);function n(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();